<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>py-patract</title>
    <meta name="generator" content="VuePress 1.8.2">
    <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <link rel="alternate" type="application/atom+xml" href="https://patractlabs.github.io/substrate-contracts-book/atom.xml" title=" Atom Feed">
    <link rel="alternate" type="application/json" href="https://patractlabs.github.io/substrate-contracts-book/feed.json" title=" JSON Feed">
    <link rel="alternate" type="application/rss+xml" href="https://patractlabs.github.io/substrate-contracts-book/rss.xml" title=" RSS Feed">
    <link rel="manifest" href="/substrate-contracts-book/manifest.webmanifest" crossorigin="use-credentials">
    <meta name="description" content="">
    <meta property="og:url" content="/substrate-contracts-book/himalia/py-patract.html">
    <meta property="og:title" content="py-patract">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="zh-CN">
    <meta property="og:locale:alternate" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="article:author" content="patractlabs">
    <meta name="theme-color" content="#46bd87">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <link rel="preload" href="/substrate-contracts-book/assets/css/0.styles.50204389.css" as="style"><link rel="preload" href="/substrate-contracts-book/assets/js/app.af2ea1b0.js" as="script"><link rel="preload" href="/substrate-contracts-book/assets/js/layout-Layout.c63f724a.js" as="script"><link rel="preload" href="/substrate-contracts-book/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.dd92595a.js" as="script"><link rel="preload" href="/substrate-contracts-book/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.d464c7d8.js" as="script"><link rel="preload" href="/substrate-contracts-book/assets/js/vendors~layout-Blog~layout-Layout.fa83db2a.js" as="script"><link rel="preload" href="/substrate-contracts-book/assets/js/page-py-patract.46ab376d.js" as="script"><link rel="prefetch" href="/substrate-contracts-book/assets/js/86.d2391560.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/87.ac464de4.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/88.4413ae31.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/89.bc68f1fa.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/90.f3d154c9.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/layout-Blog.2fb8f0e2.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/layout-NotFound.ac6e8532.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/layout-Slide.84640c11.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page--743a0c12.076481e1.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-@redspotchai.fd5399de.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-@redspotgas-reporter.d89b67d0.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-@redspotpatract.5e6c382f.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-APIaccess.6bfe71b4.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-API接入.17acb837.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-AccessControl.22c85c7b.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Ask!.3d9c13d5.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Benchmark.5168216a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-BriefintroductionofWasm.17d73b2f.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Carpo.8a6c0e32.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Configure.a449c022.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Console.ddd9ee49.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Contract.bb080d1c.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-ContractSystemOverview.fc84d6e9.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Contractlanguage(framework).b2a8e073.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Contractmodel.07bc3f5e.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Design.1cc72b08.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-DesignBrief.1cce107f.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-ERC20.b0676ca3.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Elara.0ab6cb1d.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Europa.b429cc27.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-EuropaWasmexecutor.89825ed5.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Europacontractexecutionloginformationinterpretation.5163c492.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Europadebuggingexample.b489fa23.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Europatutorial.0c50089a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Europa合约执行日志信息解释.a8bbf738.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Europa的WasmBacktrace.da10194b.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Europa调试示例.54e17ef0.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Example.ce00b7a2.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Gettingstarted.c6943ee9.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Himalia.5e553ed0.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Introduction.c1075aea.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Metis.7cccfdc3.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Overview.8ab37d6b.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Patract.f3b87e59.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Plugins.548dfeac.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-PublishDApp.d5b0ce03.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-QA.1a508bbc.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Redspot.b43e709f.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-RuntimeEnvironment.56ebcb2a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Solang.21b0522b.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-SubstrateContractsBook.07c4c4c8.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Substrate合约书.1205a625.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Summary.f3d4a5d5.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Tutorial.c42349d6.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-Wasm简要介绍.cf2b7a3f.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-cargo-contract.fa1eb96a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-example.88d4aff7.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-go-patract.c9a22806.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-ink!Framework.30ee7030.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-ink!eDSLbasicelements.7a41db2d.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-ink!eDSL基础元素.5737f07d.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-ink!tutorial.0f0cc6b9.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-ink!与solidity的对比.a8bd4eef.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-ink!当前的坑.84ff09a4.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-ink!框架.64df940e.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-ink!跨合约调用.2c874de7.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-ink.25c683e4.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-pallet-contracts合约模块.d2f9cbf8.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-tutorial.2fd6548d.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-zkMega.7f0ce666.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-介绍.62d20599.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-发布DApp.d83b035a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-合约模型.79cb41d0.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-合约综述.4bbe1f4a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-合约语言（框架）.a13bb584.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-基础.4d1b1ddf.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-控制台console.dacb0430.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-插件.364a412b.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-设计.9de8d662.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-设计简述.213c6fb3.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/page-配置.8d3f8252.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/vendors~flowchart.abe9e88a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/vendors~photo-swipe.dd9b6b8a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/vendors~reveal.71721ccb.js">
    <link rel="stylesheet" href="/substrate-contracts-book/assets/css/0.styles.50204389.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><button class="sidebar-button"><span class="icon"></span></button> <a href="/substrate-contracts-book/" class="home-link router-link-active"><img src="/substrate-contracts-book/logo.svg" alt="" class="logo"> <!----> <!----></a> <div class="links"><button class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">主题色:</label> <li><a href="#" class="default-theme"></a></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">主题模式:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0 0 42.667-42.667V128a42.667 42.667 0 0 0-85.334 0v85.333A42.667 42.667 0 0 0 512 256zm384 213.333h-85.333a42.667 42.667 0 0 0 0 85.334H896a42.667 42.667 0 0 0 0-85.334zM256 512a42.667 42.667 0 0 0-42.667-42.667H128a42.667 42.667 0 0 0 0 85.334h85.333A42.667 42.667 0 0 0 256 512zm9.387-298.667a42.667 42.667 0 0 0-59.307 62.72l61.44 59.307a42.667 42.667 0 0 0 31.147 11.947 42.667 42.667 0 0 0 30.72-13.227 42.667 42.667 0 0 0 0-60.16zm459.946 133.974a42.667 42.667 0 0 0 29.44-11.947l61.44-59.307a42.667 42.667 0 0 0-57.6-62.72l-61.44 60.587a42.667 42.667 0 0 0 0 60.16 42.667 42.667 0 0 0 28.16 13.227zM512 768a42.667 42.667 0 0 0-42.667 42.667V896a42.667 42.667 0 0 0 85.334 0v-85.333A42.667 42.667 0 0 0 512 768zm244.48-79.36a42.667 42.667 0 0 0-59.307 61.44l61.44 60.587a42.667 42.667 0 0 0 29.44 11.946 42.667 42.667 0 0 0 30.72-12.8 42.667 42.667 0 0 0 0-60.586zm-488.96 0-61.44 59.307a42.667 42.667 0 0 0 0 60.586 42.667 42.667 0 0 0 30.72 12.8 42.667 42.667 0 0 0 28.587-10.666l61.44-59.307a42.667 42.667 0 0 0-59.307-61.44zM512 341.333A170.667 170.667 0 1 0 682.667 512 170.667 170.667 0 0 0 512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 0 0-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 0 0-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/substrate-contracts-book/" class="nav-link router-link-active"><i class="iconfont icon-home"></i>
  Doc
</a></div></nav> <div class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" style="width:1rem;height:1rem;vertical-align:middle;margin-left:1rem;"><path d="M639.981 344.075c14.805 44.45 34.542 79.023 69.084 113.596 29.603-29.634 49.34-69.146 64.145-113.596H639.981zM314.33 591.024h128.29l-64.145-172.865-64.145 172.865z" fill="currentColor"></path> <path d="M807.746 116.882H215.643c-54.274 0-98.681 44.45-98.681 98.78v592.677c0 54.329 44.407 98.78 98.68 98.78h592.104c54.273 0 98.681-44.451 98.681-98.78V215.66c0-54.329-39.475-98.78-98.68-98.78zM565.971 754.01c-9.866 9.878-19.738 9.878-29.603 9.878-4.94 0-14.805 0-19.738-4.939-4.939-4.939-9.872 0-9.872-4.939s-4.932-9.878-9.865-19.756c-4.94-9.878-4.94-14.817-9.872-24.695L467.29 655.23H294.592l-19.737 54.33c-9.866 19.755-14.805 34.572-19.738 44.45-4.939 9.878-14.804 9.878-29.603 9.878-9.871 0-19.737-4.939-29.609-9.878-9.865-9.878-14.798-14.817-14.798-24.695 0-4.939 0-9.878 4.933-19.756 4.939-9.878 4.939-14.817 9.865-24.695l108.553-276.583c4.939-9.878 4.939-19.756 9.872-29.633 4.932-9.878 9.865-19.756 14.798-24.695 4.939-4.94 9.872-14.817 19.737-19.756 9.872-4.94 19.738-4.94 29.61-4.94 9.865 0 19.73 0 29.603 4.94 9.865 4.939 14.804 9.878 19.737 19.756 4.933 4.939 9.866 14.817 14.798 24.695 4.94 9.877 9.872 19.755 14.805 34.572l108.553 271.644c9.865 19.756 14.804 34.573 14.804 44.451-4.939 4.94-9.872 14.817-14.804 24.695zm271.378-192.62c-54.273-19.756-93.748-44.451-128.29-74.085-34.536 34.573-78.943 59.268-133.223 74.085l-14.798-24.695c54.273-14.817 98.68-34.573 133.223-69.146-34.542-34.573-64.145-79.024-74.017-128.413h-49.34V319.38h133.228c-9.877-14.817-19.743-34.573-29.609-49.39l14.799-4.94c9.871 14.818 24.676 34.574 34.542 54.33h123.35v24.695h-49.34c-14.798 49.39-39.468 93.84-69.077 123.474 34.541 29.634 74.01 54.329 128.29 69.146l-19.738 24.695z" fill="currentColor"></path></svg> <span class="arrow down"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/substrate-contracts-book/himalia/py-patract/" aria-current="page" class="nav-link router-link-exact-active router-link-active active"><!---->
  简体中文
</a></li><li class="dropdown-item"><a href="/substrate-contracts-book/en/himalia/py-patract/" class="nav-link"><!---->
  English
</a></li></ul></div></div></div> <a rel="noopener noreferrer" href="https://github.com/patractlabs/substrate-contracts-book" target="_blank" class="repo-link can-hide">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <nav class="sidebar-nav-links"><div class="nav-item"><a href="/substrate-contracts-book/" class="nav-link router-link-active"><i class="iconfont icon-home"></i>
  Doc
</a></div> <a rel="noopener noreferrer" href="https://github.com/patractlabs/substrate-contracts-book" target="_blank" class="repo-link">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/substrate-contracts-book/" aria-current="page" class="sidebar-link">Summary</a></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/introduction" class="sidebar-heading clickable"><!----> <span class="title">介绍</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/contracts/overview/" class="sidebar-link">合约综述</a></li><li><a href="/substrate-contracts-book/contracts/model/" class="sidebar-link">合约模型</a></li><li><a href="/substrate-contracts-book/contracts/language/" class="sidebar-link">合约语言（框架）</a></li><li><a href="/substrate-contracts-book/contracts/wasm_first_step/" class="sidebar-link">Wasm简要介绍</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/ink/introduction" class="sidebar-heading clickable"><!----> <span class="title">ink!</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/ink/tutorial/" class="sidebar-link">ink! tutorial</a></li><li><a href="/substrate-contracts-book/ink/framework/" class="sidebar-link">ink! 框架</a></li><li><a href="/substrate-contracts-book/ink/edsl-basic/" class="sidebar-link">ink! eDSL基础元素</a></li><li><a href="/substrate-contracts-book/ink/call-contracts/" class="sidebar-link">ink! 跨合约调用</a></li><li><a href="/substrate-contracts-book/ink/ink-solidity/" class="sidebar-link">ink! 与solidity的对比</a></li><li><a href="/substrate-contracts-book/ink/cargo-contract/" class="sidebar-link">cargo-contract</a></li><li><a href="/substrate-contracts-book/ink/trap/" class="sidebar-link">ink! 当前的坑</a></li></ul></section></li><li><a href="/substrate-contracts-book/solang/introduction/" class="sidebar-link">Solang</a></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/redspot/introduction" class="sidebar-heading clickable"><!----> <span class="title">Redspot</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/redspot/tutorial/" class="sidebar-link">tutorial</a></li><li><a href="/substrate-contracts-book/redspot/overview/" class="sidebar-link">介绍</a></li><li><a href="/substrate-contracts-book/redspot/configuration/" class="sidebar-link">配置</a></li><li><a href="/substrate-contracts-book/redspot/runtime-environment/" class="sidebar-link">Runtime Environment</a></li><li><a href="/substrate-contracts-book/redspot/console/" class="sidebar-link">控制台console</a></li><li><a href="/substrate-contracts-book/redspot/q-and-a/" class="sidebar-link">Q &amp; A</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/substrate-contracts-book/redspot/plugin" class="sidebar-heading clickable"><!----> <span class="title">Plugin</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/redspot/plugin/redspot-chai/" class="sidebar-link">@redspot/chai</a></li><li><a href="/substrate-contracts-book/redspot/plugin/redspot-gas-reporter/" class="sidebar-link">@redspot/gas-reporter</a></li><li><a href="/substrate-contracts-book/redspot/plugin/redspot-patract/" class="sidebar-link">@redspot/patract</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/europa/introduction" class="sidebar-heading clickable"><!----> <span class="title">Europa</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/europa/tutorial/" class="sidebar-link">Europa tutorial</a></li><li><a href="/substrate-contracts-book/europa/execution_info/" class="sidebar-link">Europa 合约执行日志信息解释</a></li><li><a href="/substrate-contracts-book/europa/sample/" class="sidebar-link">Europa 调试示例</a></li><li><a href="/substrate-contracts-book/europa/wasm_executor/" class="sidebar-link">Europa Wasm executor</a></li><li><a href="/substrate-contracts-book/europa/wasm_backtrace/" class="sidebar-link">Europa 的Wasm Backtrace</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/zkmega/introduction" class="sidebar-heading clickable"><!----> <span class="title">zkMega</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/zkmega/tutorial/" class="sidebar-link">tutorial</a></li><li><a href="/substrate-contracts-book/zkmega/contract/" class="sidebar-link">Contract</a></li><li><a href="/substrate-contracts-book/zkmega/example/" class="sidebar-link">Example</a></li><li><a href="/substrate-contracts-book/zkmega/benchmark/" class="sidebar-link">Benchmark</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/himalia/introduction" class="sidebar-heading clickable open"><!----> <span class="title">Himalia</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/himalia/tutorial/" class="sidebar-link">tutorial</a></li><li><a href="/substrate-contracts-book/himalia/go-patract/" class="sidebar-link">go-patract</a></li><li><a href="/substrate-contracts-book/himalia/py-patract/" aria-current="page" class="active sidebar-link">py-patract</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/substrate-contracts-book/himalia/py-patract/#basic-apis-for-contracts" class="sidebar-link">Basic Apis For Contracts</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/substrate-contracts-book/himalia/py-patract/#contractfactory-and-contractapi-is-used-to-react-with-contracts" class="sidebar-link heading3">ContractFactory and ContractAPI is used to react with contracts</a></li><li class="sidebar-sub-header"><a href="/substrate-contracts-book/himalia/py-patract/#contractobserver-is-used-to-listen-contracts-events" class="sidebar-link heading3">ContractObserver is used to listen contracts events</a></li></ul></li><li class="sidebar-sub-header"><a href="/substrate-contracts-book/himalia/py-patract/#special-case-erc20-api" class="sidebar-link">Special case: ERC20 API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/substrate-contracts-book/himalia/py-patract/#observer-for-contracts" class="sidebar-link heading3">Observer For Contracts</a></li></ul></li><li class="sidebar-sub-header"><a href="/substrate-contracts-book/himalia/py-patract/#unittest-node-environment" class="sidebar-link">Unittest Node Environment</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/metis/introduction" class="sidebar-heading clickable"><!----> <span class="title">Metis</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/metis/tokens/" class="sidebar-link">ERC20</a></li><li><a href="/substrate-contracts-book/metis/access-control/" class="sidebar-link">Access Control</a></li></ul></section></li><li><a href="/substrate-contracts-book/carpo/introduction/" class="sidebar-link">Carpo</a></li><li><a href="/substrate-contracts-book/patract/introduction/" class="sidebar-link">Patract</a></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/elara/introduction" class="sidebar-heading clickable"><!----> <span class="title">Elara</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/elara/tutorial/" class="sidebar-link">Tutorial</a></li><li><a href="/substrate-contracts-book/elara/design/" class="sidebar-link">设计简述</a></li><li><a href="/substrate-contracts-book/elara/API/" class="sidebar-link">API 接入</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/patra-store/introduction" class="sidebar-heading clickable"><!----> <span class="title">PatraStore</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/patra-store/overview/" class="sidebar-link">Overview</a></li><li><a href="/substrate-contracts-book/patra-store/getting-starter/" class="sidebar-link">Getting started</a></li><li><a href="/substrate-contracts-book/patra-store/publish-dapps/" class="sidebar-link">发布DApp</a></li></ul></section></li></ul> </aside> <main class="page"><nav class="breadcrumb disable"><!----></nav>  <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">py-patract</span></h1> <div class="page-info"><!----> <!----><span aria-label="写作日期📅" data-balloon-pos="down" class="time-info"><svg viewBox="0 0 1030 1024" xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H180.6A134.314 134.314 0 0 0 46.66 277.595v535.756A134.314 134.314 0 0 0 180.6 947.289h669.74a134.36 134.36 0 0 0 133.94-133.938V277.595a134.314 134.314 0 0 0-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 0 1-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 0 1-33.472 33.473z" fill="currentColor"></path></svg> <span property="datePublished">2021年4月1日 09:25</span></span><!----><span aria-label="阅读时间⌛" data-balloon-pos="down" class="reading-time-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon timer-icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z" fill="currentColor"></path></svg> <span>大约 4 分钟</span> <meta property="timeRequired" content="PT4M"></span></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/substrate-contracts-book/himalia/py-patract/#basic-apis-for-contracts" class="anchor-link heading2"><div>Basic Apis For Contracts</div></a></li><li class="anchor"><a href="/substrate-contracts-book/himalia/py-patract/#contractfactory-and-contractapi-is-used-to-react-with-contracts" class="anchor-link heading3"><div>ContractFactory and ContractAPI is used to react with contracts</div></a></li><li class="anchor"><a href="/substrate-contracts-book/himalia/py-patract/#contractobserver-is-used-to-listen-contracts-events" class="anchor-link heading3"><div>ContractObserver is used to listen contracts events</div></a></li><li class="anchor"><a href="/substrate-contracts-book/himalia/py-patract/#special-case-erc20-api" class="anchor-link heading2"><div>Special case: ERC20 API</div></a></li><li class="anchor"><a href="/substrate-contracts-book/himalia/py-patract/#observer-for-contracts" class="anchor-link heading3"><div>Observer For Contracts</div></a></li><li class="anchor"><a href="/substrate-contracts-book/himalia/py-patract/#unittest-node-environment" class="anchor-link heading2"><div>Unittest Node Environment</div></a></li></ul></div></aside></div> <div class="theme-default-content content__default"><h1 id="py-patract"><a href="#py-patract" class="header-anchor">#</a> py-patract</h1> <p>PatractPy is a contract SDK to support the development of Python scripts that interact with contracts, including automated scripts to support testing. Unlike PatractGo, PatractPy is mainly for script development, so PatractPy mainly completes contract-related RPC interfaces, and completes contract deployment and instantiation-related operations.</p> <p>PatractPy will provide support for <a href="https://github.com/patractlabs/europa" target="_blank" rel="noopener noreferrer">europa<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> env, which is a good environment for contract exec sandbox,
With PatractPy, we can write contract unittest by python, which is more friendly to developer and can easy use other test tools.</p> <p>PatractPy will be based on <a href="https://github.com/polkascan/py-substrate-interface" target="_blank" rel="noopener noreferrer">polkascan's Python Substrate Interface<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, which is a Python sdk for Substrate.</p> <p>Element Group for disscusion: https://app.element.io/#/room/#PatractLabsDev:matrix.org</p> <p>PatractPy will achieve the following support:</p> <ul><li>Some support that missing in <a href="https://github.com/polkascan/py-substrate-interface" target="_blank" rel="noopener noreferrer">polkascan's Python Substrate Interface<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, which is needed for contracts</li> <li>Provide Scanning and monitoring support for contract to do statistics and analysis</li> <li>Provide a SDK development example for ERC20 contract</li> <li>Support For unittest to canvas or <a href="https://github.com/patractlabs/europa" target="_blank" rel="noopener noreferrer">europa<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> env.</li></ul> <h2 id="basic-apis-for-contracts"><a href="#basic-apis-for-contracts" class="header-anchor">#</a> Basic Apis For Contracts</h2> <p>As <a href="https://github.com/polkascan/py-substrate-interface" target="_blank" rel="noopener noreferrer">polkascan's Python Substrate Interface<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> has provide some support to contract api, so we not need to important the api for contract calls, but there is some api to add:</p> <ul><li><code>SubstrateSubscriber</code> is a subscriber support to subscribe data changes in chain, for example, the events in chain.</li> <li><code>get_contract_event_type</code> add event decode support for contracts.</li></ul> <p>The basic api split into 2 parts:</p> <ul><li>Contract, include:
<ul><li>contractExecutor: This api could construct an extrinsic to call a contract, would be packed into a block and change state.</li> <li>contractReader: This api could construct a rpc request to call a contract, do not pack into a block and do not change any state.</li> <li>contractCreator: This api is used for <code>instantiate</code> a contract and holding the WASM code and metadata, receive following parameters:
<ul><li><code>gas_limit</code></li> <li><code>endowment</code></li> <li><code>deployment_salt</code> (<code>salt</code> parameter in <code>instantiate</code>)</li></ul></li> <li>ContractAPI: This api is used for <code>call</code> a contract, is a wrapper for <code>contractExecutor</code> and <code>contractReader</code>, developers could use this api to react with contracts. This api could create a instance depends on the metadata, auto generate the contract access functions based on the contract. And the auto-gen functions receive the parameters which defined in contracts, besides receive following common parameters:
<ul><li><code>gas_limit</code></li> <li><code>value</code> (notice, if current call's <code>payable</code> is false, this <code>value</code> must be <code>0</code>)</li></ul></li> <li>ContractFactory: This api is used for constructing a contract instance in python, and developer could use this instance to access contract. This is a wrapper for <code>contractCreator</code> and <code>ContractAPI</code></li></ul></li> <li>Observer, include:
<ul><li>ContractObserver: This api is used for listen the events in contracts.</li></ul></li></ul> <p>All methods which belong to the instance of <code>ContractAPI</code> and <code>ContractFactory</code> <strong>receive a keypair as the first parameter</strong>, as the sender for this operation. And from the second parameter, receive the parameters defined in contracts.</p> <h3 id="contractfactory-and-contractapi-is-used-to-react-with-contracts"><a href="#contractfactory-and-contractapi-is-used-to-react-with-contracts" class="header-anchor">#</a> <code>ContractFactory</code> and <code>ContractAPI</code> is used to react with contracts</h3> <p>we add a factory to put code and deploy contracts to chain:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>factory <span class="token operator">=</span> ContractFactory<span class="token punctuation">.</span>create_from_file<span class="token punctuation">(</span>
    substrate<span class="token operator">=</span>substrate<span class="token punctuation">,</span> 
    code_file<span class="token operator">=</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'constracts'</span><span class="token punctuation">,</span> <span class="token string">'ink'</span><span class="token punctuation">,</span> <span class="token string">'erc20.wasm'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    metadata_file<span class="token operator">=</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'constracts'</span><span class="token punctuation">,</span> <span class="token string">'ink'</span><span class="token punctuation">,</span> <span class="token string">'erc20.json'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

res <span class="token operator">=</span> factory<span class="token punctuation">.</span>put_code<span class="token punctuation">(</span>alice<span class="token punctuation">)</span> <span class="token comment"># alice is the keypair for `//Alice`</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>is_succes<span class="token punctuation">)</span>

<span class="token comment"># this api is `ContractAPI`</span>
api <span class="token operator">=</span> factory<span class="token punctuation">.</span>new<span class="token punctuation">(</span>alice<span class="token punctuation">,</span> <span class="token number">1000000</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">**</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> endowment<span class="token operator">=</span><span class="token number">10</span><span class="token operator">**</span><span class="token number">15</span><span class="token punctuation">,</span> gas_limit<span class="token operator">=</span><span class="token number">1000000000000</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>contract_address<span class="token punctuation">)</span> <span class="token comment"># contract_address is the deployed contract</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>The factory will generate constructors from metadata file.</p> <p>We add api by metadata for Contract, api will auto generate caller for contract from metadata:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># create a ContractAPI from an existed contract address</span>
api <span class="token operator">=</span> ContractAPI<span class="token punctuation">(</span>contract_address<span class="token punctuation">,</span> contract_metadata<span class="token punctuation">,</span> substrate<span class="token punctuation">)</span>

<span class="token comment"># api will auto generate caller for contract from metadata</span>
alice_balance_old <span class="token operator">=</span> api<span class="token punctuation">.</span>balance_of<span class="token punctuation">(</span>bob<span class="token punctuation">,</span> alice<span class="token punctuation">.</span>ss58_address<span class="token punctuation">)</span> <span class="token comment"># bob is the keypair for `//Bob`</span>

res <span class="token operator">=</span> api<span class="token punctuation">.</span>transfer<span class="token punctuation">(</span>alice<span class="token punctuation">,</span> bob<span class="token punctuation">.</span>ss58_address<span class="token punctuation">,</span> <span class="token number">100000</span><span class="token punctuation">,</span> gas_limit<span class="token operator">=</span><span class="token number">20000000000</span><span class="token punctuation">)</span>
logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'transfer res </span><span class="token interpolation"><span class="token punctuation">{</span>res<span class="token punctuation">.</span>error_message<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>is_succes<span class="token punctuation">)</span>

alice_balance <span class="token operator">=</span> api<span class="token punctuation">.</span>balance_of<span class="token punctuation">(</span>bob<span class="token punctuation">,</span> alice<span class="token punctuation">.</span>ss58_address<span class="token punctuation">)</span>
logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'transfer alice_balance </span><span class="token interpolation"><span class="token punctuation">{</span>alice_balance<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

bob_balance <span class="token operator">=</span> api<span class="token punctuation">.</span>balance_of<span class="token punctuation">(</span>bob<span class="token punctuation">,</span> bob<span class="token punctuation">.</span>ss58_address<span class="token punctuation">)</span>
logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'transfer bob_balance </span><span class="token interpolation"><span class="token punctuation">{</span>bob_balance<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>The api will generate exec and read api from metadata file, for example:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code>      <span class="token punctuation">{</span>
        <span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;owner&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;displayName&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;AccountId&quot;</span>
              <span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">5</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;docs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot; Returns the account balance for the specified `owner`.&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot; Returns `0` if the account is non-existent.&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;mutates&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;balance_of&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;payable&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">&quot;returnType&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;displayName&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;Balance&quot;</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;selector&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x56e929b2&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>In api, can call by:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>bob_balance <span class="token operator">=</span> api<span class="token punctuation">.</span>balance_of<span class="token punctuation">(</span>bob<span class="token punctuation">,</span> bob<span class="token punctuation">.</span>ss58_address<span class="token punctuation">)</span>
logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'transfer bob_balance </span><span class="token interpolation"><span class="token punctuation">{</span>bob_balance<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="contractobserver-is-used-to-listen-contracts-events"><a href="#contractobserver-is-used-to-listen-contracts-events" class="header-anchor">#</a> <code>ContractObserver</code> is used to listen contracts events</h3> <p>ContractObserver can observer events for a contract:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>substrate<span class="token operator">=</span>SubstrateInterface<span class="token punctuation">(</span>url<span class="token operator">=</span><span class="token string">&quot;ws://127.0.0.1:9944&quot;</span><span class="token punctuation">,</span> type_registry_preset<span class="token operator">=</span><span class="token string">'canvas'</span><span class="token punctuation">)</span>
contract_metadata <span class="token operator">=</span> ContractMetadata<span class="token punctuation">.</span>create_from_file<span class="token punctuation">(</span>
    metadata_file<span class="token operator">=</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'constracts'</span><span class="token punctuation">,</span> <span class="token string">'ink'</span><span class="token punctuation">,</span> <span class="token string">'erc20.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    substrate<span class="token operator">=</span>substrate
<span class="token punctuation">)</span>
observer <span class="token operator">=</span> ContractObserver<span class="token punctuation">(</span><span class="token string">&quot;0x8eaf04151687736326c9fea17e25fc5287613693c912909cb226aa4794f26a48&quot;</span><span class="token punctuation">,</span> contract_metadata<span class="token punctuation">,</span> substrate<span class="token punctuation">)</span>

<span class="token comment"># for some handlers (callbacks)</span>
observer<span class="token punctuation">.</span>scanEvents<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>The handler function can take the erc20 support as a example.</p> <h2 id="special-case-erc20-api"><a href="#special-case-erc20-api" class="header-anchor">#</a> Special case: ERC20 API</h2> <p>Except react contract by <code>ContractAPI</code>, developers could create the wrapper by themself to react with corresponding contract. <code>py-contract</code> create an <code>ERC20 API</code> as an example to show this.</p> <p>ERC20 api provide a wapper to erc20 contract exec, read and observer events, it can be a example for contracts api calling.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>
<span class="token comment"># init api</span>
substrate<span class="token operator">=</span>SubstrateInterface<span class="token punctuation">(</span>url<span class="token operator">=</span><span class="token string">&quot;ws://127.0.0.1:9944&quot;</span><span class="token punctuation">,</span> type_registry_preset<span class="token operator">=</span><span class="token string">'canvas'</span><span class="token punctuation">)</span>

contract_metadata <span class="token operator">=</span> ContractMetadata<span class="token punctuation">.</span>create_from_file<span class="token punctuation">(</span>
    metadata_file<span class="token operator">=</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'constracts'</span><span class="token punctuation">,</span> <span class="token string">'ink'</span><span class="token punctuation">,</span> <span class="token string">'erc20.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    substrate<span class="token operator">=</span>substrate
<span class="token punctuation">)</span>

alice <span class="token operator">=</span> Keypair<span class="token punctuation">.</span>create_from_uri<span class="token punctuation">(</span><span class="token string">'//Alice'</span><span class="token punctuation">)</span>
bob <span class="token operator">=</span> Keypair<span class="token punctuation">.</span>create_from_uri<span class="token punctuation">(</span><span class="token string">'//Bob'</span><span class="token punctuation">)</span>

<span class="token comment"># erc20 api</span>
erc20 <span class="token operator">=</span> ERC20<span class="token punctuation">.</span>create_from_contracts<span class="token punctuation">(</span>
    substrate<span class="token operator">=</span> substrate<span class="token punctuation">,</span> 
    contract_file<span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'constracts'</span><span class="token punctuation">,</span> <span class="token string">'ink'</span><span class="token punctuation">,</span> <span class="token string">'erc20.wasm'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    metadata_file<span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'constracts'</span><span class="token punctuation">,</span> <span class="token string">'ink'</span><span class="token punctuation">,</span> <span class="token string">'erc20.json'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># deplay a erc20 contract</span>
erc20<span class="token punctuation">.</span>put_and_deploy<span class="token punctuation">(</span>alice<span class="token punctuation">,</span> <span class="token number">1000000</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">**</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># read total supply</span>
total_supply <span class="token operator">=</span> erc20<span class="token punctuation">.</span>totalSupply<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># transfer</span>
erc20<span class="token punctuation">.</span>transfer_from<span class="token punctuation">(</span>alice<span class="token punctuation">,</span>
    from_acc<span class="token operator">=</span>alice<span class="token punctuation">.</span>ss58_address<span class="token punctuation">,</span> 
    to_acc<span class="token operator">=</span>bob<span class="token punctuation">.</span>ss58_address<span class="token punctuation">,</span> 
    amt<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">)</span>

erc20<span class="token punctuation">.</span>transfer<span class="token punctuation">(</span>alice<span class="token punctuation">,</span> bob<span class="token punctuation">.</span>ss58_address<span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span>

<span class="token comment"># get balance</span>
alice_balance <span class="token operator">=</span> erc20<span class="token punctuation">.</span>balance_of<span class="token punctuation">(</span>alice<span class="token punctuation">.</span>ss58_address<span class="token punctuation">)</span>

<span class="token comment"># approve</span>
erc20<span class="token punctuation">.</span>approve<span class="token punctuation">(</span>alice<span class="token punctuation">,</span> spender<span class="token operator">=</span>bob<span class="token punctuation">.</span>ss58_address<span class="token punctuation">,</span> amt<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">)</span>

<span class="token comment"># get allowance</span>
alice_allowance <span class="token operator">=</span> erc20<span class="token punctuation">.</span>allowance<span class="token punctuation">(</span>alice<span class="token punctuation">.</span>ss58_address<span class="token punctuation">,</span> bob<span class="token punctuation">.</span>ss58_address<span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p><code>ERC20Observer</code> is a event observer for erc20 contract:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>observer <span class="token operator">=</span> ERC20Observer<span class="token punctuation">.</span>create_from_address<span class="token punctuation">(</span>
    substrate <span class="token operator">=</span> substrate<span class="token punctuation">,</span> 
    contract_address <span class="token operator">=</span> contract_address<span class="token punctuation">,</span>
    metadata_file<span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'constracts'</span><span class="token punctuation">,</span> <span class="token string">'ink'</span><span class="token punctuation">,</span> <span class="token string">'erc20.json'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">on_transfer</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&quot;on_transfer in {} : {} {} {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> evt<span class="token punctuation">[</span><span class="token string">'from'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> evt<span class="token punctuation">[</span><span class="token string">'to'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> evt<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">on_approval</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&quot;on_approval in {} : {} {} {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> evt<span class="token punctuation">[</span><span class="token string">'owner'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> evt<span class="token punctuation">[</span><span class="token string">'spender'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> evt<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


observer<span class="token punctuation">.</span>scanEvents<span class="token punctuation">(</span>on_transfer <span class="token operator">=</span> on_transfer<span class="token punctuation">,</span> on_approval <span class="token operator">=</span> on_approval<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="observer-for-contracts"><a href="#observer-for-contracts" class="header-anchor">#</a> Observer For Contracts</h3> <p><code>ContractObserver</code> is a observer to listen events by contract with a given address:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>observer <span class="token operator">=</span> ContractObserver<span class="token punctuation">.</span>create_from_address<span class="token punctuation">(</span>
    substrate <span class="token operator">=</span> substrate<span class="token punctuation">,</span> 
    contract_address <span class="token operator">=</span> <span class="token string">'contract_address'</span><span class="token punctuation">,</span>
    metadata_file<span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'constracts'</span><span class="token punctuation">,</span> <span class="token string">'ink'</span><span class="token punctuation">,</span> <span class="token string">'erc20.json'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">on_transfer</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&quot;on_transfer in {} : {} {} {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> evt<span class="token punctuation">[</span><span class="token string">'from'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> evt<span class="token punctuation">[</span><span class="token string">'to'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> evt<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">on_approval</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&quot;on_approval in {} : {} {} {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> evt<span class="token punctuation">[</span><span class="token string">'owner'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> evt<span class="token punctuation">[</span><span class="token string">'spender'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> evt<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

observer<span class="token punctuation">.</span>scanEvents<span class="token punctuation">(</span>from_num<span class="token punctuation">,</span> to_num<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string">'Transfer'</span><span class="token punctuation">:</span> on_transfer<span class="token punctuation">,</span>
    <span class="token string">'Approve'</span><span class="token punctuation">:</span> on_approval
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><code>handlers</code> is a hander dictionary by name to hander function.</p> <h2 id="unittest-node-environment"><a href="#unittest-node-environment" class="header-anchor">#</a> Unittest Node Environment</h2> <p>PatractPy can support write contract unittest by node environment.</p> <p>At First We need install <a href="https://github.com/patractlabs/europa" target="_blank" rel="noopener noreferrer">europa<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> patractinterface<span class="token punctuation">.</span>contracts<span class="token punctuation">.</span>erc20 <span class="token keyword">import</span> ERC20
<span class="token keyword">from</span> patractinterface<span class="token punctuation">.</span>unittest<span class="token punctuation">.</span>env <span class="token keyword">import</span> SubstrateTestEnv

<span class="token keyword">class</span> <span class="token class-name">UnittestEnvTest</span><span class="token punctuation">(</span>unittest<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@classmethod</span>
    <span class="token keyword">def</span> <span class="token function">setUp</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># start env or use canvas for a 6s block</span>
        cls<span class="token punctuation">.</span>env <span class="token operator">=</span> SubstrateTestEnv<span class="token punctuation">.</span>create_europa<span class="token punctuation">(</span>port<span class="token operator">=</span><span class="token number">39944</span><span class="token punctuation">)</span>
        cls<span class="token punctuation">.</span>env<span class="token punctuation">.</span>start_node<span class="token punctuation">(</span><span class="token punctuation">)</span>

        cls<span class="token punctuation">.</span>api <span class="token operator">=</span> SubstrateInterface<span class="token punctuation">(</span>url<span class="token operator">=</span>cls<span class="token punctuation">.</span>env<span class="token punctuation">.</span>url<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type_registry_preset<span class="token operator">=</span>cls<span class="token punctuation">.</span>env<span class="token punctuation">.</span>typ<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type_registry<span class="token operator">=</span>cls<span class="token punctuation">.</span>env<span class="token punctuation">.</span>types<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        cls<span class="token punctuation">.</span>alice <span class="token operator">=</span> Keypair<span class="token punctuation">.</span>create_from_uri<span class="token punctuation">(</span><span class="token string">'//Alice'</span><span class="token punctuation">)</span>
        cls<span class="token punctuation">.</span>bob <span class="token operator">=</span> Keypair<span class="token punctuation">.</span>create_from_uri<span class="token punctuation">(</span><span class="token string">'//Bob'</span><span class="token punctuation">)</span>

        cls<span class="token punctuation">.</span>erc20 <span class="token operator">=</span> ERC20<span class="token punctuation">.</span>create_from_contracts<span class="token punctuation">(</span>
            substrate<span class="token operator">=</span> cls<span class="token punctuation">.</span>substrate<span class="token punctuation">,</span> 
            contract_file<span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'constracts'</span><span class="token punctuation">,</span> <span class="token string">'ink'</span><span class="token punctuation">,</span> <span class="token string">'erc20.wasm'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            metadata_file<span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'constracts'</span><span class="token punctuation">,</span> <span class="token string">'ink'</span><span class="token punctuation">,</span> <span class="token string">'erc20.json'</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        cls<span class="token punctuation">.</span>erc20<span class="token punctuation">.</span>put_and_deploy<span class="token punctuation">(</span>alice<span class="token punctuation">,</span> <span class="token number">1000000</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">**</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span>

    <span class="token keyword">def</span> <span class="token function">tearDown</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cls<span class="token punctuation">.</span>env<span class="token punctuation">.</span>stop_node<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">test_transfer</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>erc20<span class="token punctuation">.</span>transfer_from<span class="token punctuation">(</span>alice<span class="token punctuation">,</span>
            from_acc<span class="token operator">=</span>alice<span class="token punctuation">.</span>ss58_address<span class="token punctuation">,</span> 
            to_acc<span class="token operator">=</span>bob<span class="token punctuation">.</span>ss58_address<span class="token punctuation">,</span> 
            amt<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">)</span>
        <span class="token comment"># some more test case</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    unittest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>By example, we can use python to write testcase for some complex logics, by <a href="https://github.com/patractlabs/europa" target="_blank" rel="noopener noreferrer">europa<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, we can test the contracts for python scripts.</p></div> <footer class="page-meta"><div class="edit-link"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon edit-icon"><path d="M117.953 696.992 64.306 959.696l265.931-49.336 450.204-452.505-212.284-213.376-450.204 452.513zm496.384-296.326L219.039 797.993l-46.108-46.34L568.233 354.33l46.104 46.335zm345.357-122.99-114.45 115.04-212.288-213.377 114.45-115.035 212.288 213.371zm0 0" fill="currentColor"></path></svg> <a href="https://github.com/patractlabs/substrate-contracts-book/edit/master/himalia/py-patract.md" target="_blank" rel="noopener noreferrer">编辑此页</a></div> <div class="meta-item update-time"><span class="label">上次编辑于:</span> <span class="info">2021年4月1日 09:25</span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/substrate-contracts-book/himalia/go-patract/" class="prev"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon prev-icon"><path d="M906.783 588.79c-.02 8.499-6.882 15.36-15.38 15.37l-443.7-.01 75.704 191.682c2.52 6.42.482 13.763-5.038 17.91-5.52 4.168-13.138 4.147-18.616-.092L123.228 524.175a15.362 15.362 0 0 1-6-12.165c0-4.782 2.222-9.277 6-12.185L499.753 210.35a15.388 15.388 0 0 1 9.38-3.195c3.236 0 6.502 1.034 9.236 3.103 5.52 4.147 7.578 11.49 5.038 17.91L447.683 419.84l443.72-.01c8.498.01 15.36 6.881 15.36 15.36l.02 153.6z" fill="currentColor"></path></svg>
        go-patract
      </a></span> <span class="next"><a href="/substrate-contracts-book/metis/tokens/">
        ERC20
        <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon next-icon"><path d="M906.772 512c0 4.772-2.211 9.267-5.99 12.175L524.257 813.66a15.37 15.37 0 0 1-18.616.092 15.368 15.368 0 0 1-5.038-17.91l75.714-191.672h-443.73c-8.488 0-15.36-6.881-15.36-15.36v-153.6c0-8.489 6.872-15.36 15.36-15.36h443.73l-75.714-191.682a15.358 15.358 0 0 1 5.048-17.91c5.51-4.158 13.128-4.137 18.606.092l376.525 289.485a15.323 15.323 0 0 1 5.99 12.165z" fill="currentColor"></path></svg></a></span></p></div> <!----> </main> <footer class="footer-wrapper"><!----> <div class="footer">PatractLabs</div> <div class="copyright">Copyright © 2020 patractlabs</div></footer></div><div class="global-ui"><!----><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">该应用可以安装在您的 PC 或移动设备上。这将使该 Web 应用程序外观和行为与其他应用程序相同。它将在出现在应用程序列表中，并可以固定到主屏幕，开始菜单或任务栏。此 Web 应用程序还将能够与其他应用程序和您的操作系统安全地进行交互。</p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>详情</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        安装 <span></span></button> <button class="cancel-button">
        取消
      </button></div></div></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button title="Close (Esc)" class="pswp__button pswp__button--close"></button> <button title="Share" class="pswp__button pswp__button--share"></button> <button title="Toggle fullscreen" class="pswp__button pswp__button--fs"></button> <button title="Zoom in/out" class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button title="Previous (arrow left)" class="pswp__button pswp__button--arrow--left"></button> <button title="Next (arrow right)" class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/substrate-contracts-book/assets/js/app.af2ea1b0.js" defer></script><script src="/substrate-contracts-book/assets/js/layout-Layout.c63f724a.js" defer></script><script src="/substrate-contracts-book/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.dd92595a.js" defer></script><script src="/substrate-contracts-book/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.d464c7d8.js" defer></script><script src="/substrate-contracts-book/assets/js/vendors~layout-Blog~layout-Layout.fa83db2a.js" defer></script><script src="/substrate-contracts-book/assets/js/page-py-patract.46ab376d.js" defer></script>
  </body>
</html>
