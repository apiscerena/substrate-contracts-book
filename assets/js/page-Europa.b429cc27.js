(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{569:function(e,a,t){"use strict";t.r(a);var r=t(1),s=Object(r.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"europa"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#europa"}},[e._v("#")]),e._v(" Europa")]),e._v(" "),t("p",[e._v("Europa is a sandbox environment for running "),t("code",[e._v("FRAME Contracts pallet")]),e._v(" and **simulating nodes. It is also a framework for running Substrate runtime.")]),e._v(" "),t("ol",[t("li",[e._v("When Europa is used as a sandbox for contract debugging, Europa modified the "),t("code",[e._v("FRAME Contracts pallet")]),e._v(" module to track the contract execution process, which can provide contract developers with richest contract execution information to allow contract execution The process is no longer a black box**, helping contract developers to debug Wasm contracts;")]),e._v(" "),t("li",[e._v("When using Europa as the framework of Substrate, you can do Substrate Runtime development (mostly used for experimental functions) without being disturbed by Wasm compilation problems.")])]),e._v(" "),t("h2",{attrs:{id:"as-the-framework-of-substrate-runtime"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#as-the-framework-of-substrate-runtime"}},[e._v("#")]),e._v(" As the framework of Substrate runtime")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Europa removed some unnecessary functional modules, such as WASM executor, p2p, etc., and only retained the native execution environment.")])]),e._v(" "),t("li",[t("p",[e._v("The block generation method of "),t("code",[e._v("manual_seal")]),e._v(" is used (the block generation is triggered when a new transaction is received), so that developers do not have to be affected by consensus block generation, and can focus more on contract development, debugging and log analysis.")])]),e._v(" "),t("li",[t("p",[e._v("The "),t("code",[e._v("state-kv")]),e._v(" database is provided, which records the state changes of each block.")]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# print the modified state kvs for block 1")]),e._v("\n$ ./target/debug/europa state-kv "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" -d europa_database\nNov "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("12")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("15")]),e._v(":53:27.699 INFO modified state "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" block:0x6c119a8f7de42e330aca8b9d3587937aacbbc203cc21650b60644c2f2d33e7fb\nNov "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("12")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("15")]),e._v(":53:27.699 INFO key:26aa394eea5630e07c48ae0c9558cef702a5c1b19ab7a04f536c519aca4983ac"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v("value:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("DELETED"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\nNov "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("12")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("15")]),e._v(":53:27.699 INFO key:26aa394eea5630e07c48ae0c9558cef70a98fdbe9ce6c55837576c60c7af3850"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v("value:05000000\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ...")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("In addition to providing the basic rpc in the Substrate framework, Europa also has some special rpc:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("europa_forwardToHeight (params: [height: NumberOf<B>])")]),e._v(": Fast forward the block to the specified height, which is very helpful for testing functions related to the block height.")]),e._v(" "),t("li",[t("code",[e._v("europa_backwardToHeight (params: [height: NumberOf<B>])")]),e._v(": Return the block to the specified height, mainly used to restore the state.")]),e._v(" "),t("li",[t("code",[e._v("europa_modifiedStateKvs (params: [number_or_hash: NumberOrHash<B>])")]),e._v(": Provide block height or block hash, query the state change in the corresponding block.")])])]),e._v(" "),t("li",[t("p",[e._v("In addition to using the optional command of "),t("code",[e._v("-d/--base-path")]),e._v(" to divide different working directories, Europa can also use "),t("code",[e._v("-w/--workspace")]),e._v(" to declare different workspaces under the working directory.")])])]),e._v(" "),t("h2",{attrs:{id:"as-a-sandbox-environment-for-frame-contracts-pallet"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#as-a-sandbox-environment-for-frame-contracts-pallet"}},[e._v("#")]),e._v(" As a sandbox environment for "),t("code",[e._v("FRAME Contracts pallet")])]),e._v(" "),t("p",[e._v("When developing contracts, Europa provides developers with "),t("strong",[e._v("more detailed log information")]),e._v(" to assist contract developers in locating problems, including contracts execution logs and wasm execution stacks. At the same time, this sandbox environment also has the functions of the aforementioned Europa framework. For example, you can use rpc such as "),t("code",[e._v("europa_forwardToHeight")]),e._v(" to control the execution of the contract.")]),e._v(" "),t("p",[e._v("Contract errors may appear in three places: the "),t("code",[e._v("ink!")]),e._v(" layer, the internal business logic of the contract, and the "),t("code",[e._v("pallet_contracts")]),e._v(" layer. With these detailed logs, developers can quickly locate problems during debugging, especially in the case of mutual calls between contracts, Europa can greatly improve the development experience.")]),e._v(" "),t("p",[e._v("Currently, there are two custom ChainExtensions available on Europa, namely Contract logger and ZKP feature.")]),e._v(" "),t("h2",{attrs:{id:"focus-of-this-chapter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#focus-of-this-chapter"}},[e._v("#")]),e._v(" Focus of this chapter")]),e._v(" "),t("p",[e._v("Since the main focus of this book is Substrate's Wasm contract, the Europa-related introductions in the following chapters are all related to the use of Europa contract debugging.")])])}),[],!1,null,null,null);a.default=s.exports},615:function(e,a,t){"use strict";t.r(a);var r=t(1),s=Object(r.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"europa"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#europa"}},[e._v("#")]),e._v(" Europa")]),e._v(" "),t("p",[e._v("Europa是一个运行"),t("code",[e._v("FRAME Contracts pallet")]),e._v("并"),t("strong",[e._v("模拟节点的沙盒环境")]),e._v("，同时也是一个运行Substrate runtime的框架。")]),e._v(" "),t("ol",[t("li",[e._v("将Europa作为合约调试的沙盒（sandbox）时，Europa修改了"),t("code",[e._v("FRAME Contracts pallet")]),e._v("模块以跟踪合约执行过程，能够给合约开发人员提供"),t("strong",[e._v("丰富的合约执行中的信息，让合约的执行过程不再是一个黑盒")]),e._v("，帮助合约开发人员调试Wasm合约；")]),e._v(" "),t("li",[e._v("使用Europa作为Substrate的框架（framework）时，你可以在不受Wasm编译问题的干扰下做Substrate Runtime开发（多用于实验性功能）。")])]),e._v(" "),t("h2",{attrs:{id:"作为substrate-runtime的框架"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#作为substrate-runtime的框架"}},[e._v("#")]),e._v(" 作为Substrate runtime的框架")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Europa移除了一些不必要的功能模块，例如WASM executor，p2p等，仅保留了native的执行环境。")])]),e._v(" "),t("li",[t("p",[e._v("使用了"),t("code",[e._v("manual_seal")]),e._v("的出块方式（当收到新交易时就触发出块），使开发者不必受共识出块的影响，能更专注于合约的开发调试与日志分析。")])]),e._v(" "),t("li",[t("p",[e._v("提供了"),t("code",[e._v("state-kv")]),e._v("数据库，记录了每个区块的状态变更。")]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# print the modified state kvs for block 1")]),e._v("\n$ ./target/debug/europa state-kv "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" -d europa_database\nNov "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("12")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("15")]),e._v(":53:27.699  INFO modified state "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" block:0x6c119a8f7de42e330aca8b9d3587937aacbbc203cc21650b60644c2f2d33e7fb    \nNov "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("12")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("15")]),e._v(":53:27.699  INFO       key:26aa394eea5630e07c48ae0c9558cef702a5c1b19ab7a04f536c519aca4983ac"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v("value:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("DELETED"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("    \nNov "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("12")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("15")]),e._v(":53:27.699  INFO       key:26aa394eea5630e07c48ae0c9558cef70a98fdbe9ce6c55837576c60c7af3850"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v("value:05000000\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ... ")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("Europa除了提供Substrate框架中的基础rpc之外，还有一些特殊的rpc：")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("europa_forwardToHeight (params: [height: NumberOf<B>])")]),e._v("：将区块快进到指定高度，对于测试跟区块高度相关的功能非常有帮助。")]),e._v(" "),t("li",[t("code",[e._v("europa_backwardToHeight (params: [height: NumberOf<B>])")]),e._v("：将区块回退到指定高度，主要用来恢复状态。")]),e._v(" "),t("li",[t("code",[e._v("europa_modifiedStateKvs (params: [number_or_hash: NumberOrHash<B>])")]),e._v("：提供区块高度或者区块哈希，查询对应区块中的状态变更。")])])]),e._v(" "),t("li",[t("p",[e._v("Europa除了使用"),t("code",[e._v("-d/--base-path")]),e._v("的可选项命令划分不同的工作目录，还能使用"),t("code",[e._v("-w/--workspace")]),e._v("在工作目录下声明不同的工作空间。")])])]),e._v(" "),t("h2",{attrs:{id:"作为frame-contracts-pallet的沙盒环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#作为frame-contracts-pallet的沙盒环境"}},[e._v("#")]),e._v(" 作为"),t("code",[e._v("FRAME Contracts pallet")]),e._v("的沙盒环境")]),e._v(" "),t("p",[e._v("当开发合约时，Europa为开发者提供了"),t("strong",[e._v("更加详细的日志信息")]),e._v("来辅助合约开发者定位问题，包括contracts执行日志与wasm执行栈。同时这个沙盒环境也具备上述Europa框架的功能，例如可以使用"),t("code",[e._v("europa_forwardToHeight")]),e._v("等rpc来控制合约的执行情况。")]),e._v(" "),t("p",[e._v("合约错误可能出现在三处："),t("code",[e._v("ink!")]),e._v("层、合约内部业务逻辑、"),t("code",[e._v("pallet_contracts")]),e._v("层。有了这些详细的日志，使得开发者在调试时能够快速定位问题，特别是在合约间互相调用的情况下，Europa能够大幅度提升开发体验。")]),e._v(" "),t("p",[e._v("目前，在Europa上有两个自定义的ChainExtension可供使用，分别是Contract logger和ZKP feature。")]),e._v(" "),t("h2",{attrs:{id:"本章重点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#本章重点"}},[e._v("#")]),e._v(" 本章重点")]),e._v(" "),t("p",[e._v("由于本书主要关注点是Substrate的Wasm合约，因此后面章节的Europa相关的介绍均围绕与使用Europa合约调试相关。")])])}),[],!1,null,null,null);a.default=s.exports}}]);